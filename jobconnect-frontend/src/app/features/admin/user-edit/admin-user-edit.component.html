<!-- New User Form -->
@if (isNewUser() && !loading()) {
<div class="simple-form-page">
    <div class="page-header">
        <div class="header-orb header-orb-1"></div>
        <div class="header-orb header-orb-2"></div>

        <div class="header-nav">
            <button class="back-btn" (click)="goBack()">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M19 12H5M12 19l-7-7 7-7" />
                </svg>
                <span>Back to Users</span>
            </button>

            <div class="header-badge">
                <div class="badge-glow"></div>
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="badge-icon">
                    <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z" />
                </svg>
                <span>Admin Panel</span>
            </div>
        </div>

        <div class="header-content">
            <h1>Add New <span class="gradient-text">User</span></h1>
            <p>Create a new user account</p>
        </div>
    </div>

    <div class="simple-form-container">
        <div class="simple-card">
            <div class="card-icon">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2" />
                    <circle cx="12" cy="7" r="4" />
                </svg>
            </div>
            <h2>Account Details</h2>
            <p class="card-description">Enter the information for the new user account</p>

            <form [formGroup]="userForm">
                @if (userForm.get('role')?.value === 'Company') {
                <div class="form-group">
                    <label>Company Name *</label>
                    <input type="text" formControlName="firstName" placeholder="Acme Corp">
                </div>
                } @else {
                <div class="form-group">
                    <label>First Name *</label>
                    <input type="text" formControlName="firstName" placeholder="John">
                </div>

                <div class="form-group">
                    <label>Last Name</label>
                    <input type="text" formControlName="lastName" placeholder="Doe">
                </div>
                }

                <div class="form-group">
                    <label>Email *</label>
                    <input type="email" formControlName="email" placeholder="john@example.com">
                </div>

                <div class="form-group">
                    <label>Password *</label>
                    <input type="password" formControlName="password" placeholder="••••••••">
                    <span class="hint">Minimum 6 characters</span>
                </div>

                <div class="form-group">
                    <label>Role *</label>
                    <div class="role-selection">
                        @for (role of roles; track role.value) {
                        <button type="button" class="role-card"
                            [class.selected]="userForm.get('role')?.value === role.value"
                            (click)="userForm.get('role')?.setValue(role.value)">
                            <span class="role-icon">{{ role.icon }}</span>
                            <span class="role-label">{{ role.label }}</span>
                            <span class="role-desc">{{ role.description }}</span>
                        </button>
                        }
                    </div>
                </div>

                <div class="form-actions">
                    <button type="button" class="btn-secondary" (click)="goBack()">Cancel</button>
                    <button type="button" class="btn-primary" (click)="saveUser()" [disabled]="saving()">
                        @if (saving()) {
                        <span class="btn-spinner"></span>
                        Creating...
                        } @else {
                        Create User
                        }
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>
}

<!-- Edit User Form -->
@if (!isNewUser() && !loading()) {
<div class="simple-form-page">
    <div class="page-header">
        <div class="header-orb header-orb-1"></div>
        <div class="header-orb header-orb-2"></div>

        <div class="header-nav">
            <button class="back-btn" (click)="goBack()">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M19 12H5M12 19l-7-7 7-7" />
                </svg>
                <span>Back to Users</span>
            </button>

            <div class="header-badge">
                <div class="badge-glow"></div>
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="badge-icon">
                    <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z" />
                </svg>
                <span>Admin Panel</span>
            </div>
        </div>

        <div class="header-content">
            <h1>Edit <span class="gradient-text">User</span></h1>
            <p>Update user account details</p>
        </div>
    </div>

    <div class="simple-form-container">
        <div class="simple-card">
            <div class="card-icon">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2" />
                    <circle cx="12" cy="7" r="4" />
                </svg>
            </div>
            <h2>Account Details</h2>
            <p class="card-description">Update the user's information</p>

            @if (user()) {
            <div class="user-role-display">
                <span class="role-label">Role:</span>
                <span class="role-badge" [class]="'role-' + user()!.role.toLowerCase()">
                    {{ user()!.role }}
                </span>
            </div>
            }

            <form [formGroup]="userForm">
                @if (user()?.role === 'Company') {
                <div class="form-group">
                    <label>Company Name *</label>
                    <input type="text" formControlName="firstName" placeholder="Acme Corp">
                </div>
                } @else {
                <div class="form-group">
                    <label>First Name *</label>
                    <input type="text" formControlName="firstName" placeholder="John">
                </div>

                <div class="form-group">
                    <label>Last Name</label>
                    <input type="text" formControlName="lastName" placeholder="Doe">
                </div>
                }

                <div class="form-group">
                    <label>Email *</label>
                    <input type="email" formControlName="email" placeholder="john@example.com">
                </div>

                <div class="form-group">
                    <label>New Password</label>
                    <input type="password" formControlName="password" placeholder="Leave blank to keep current">
                    <span class="hint">Leave empty to keep current password</span>
                </div>

                <div class="form-actions">
                    <button type="button" class="btn-secondary" (click)="goBack()">Cancel</button>
                    <button type="button" class="btn-primary" (click)="saveUser()" [disabled]="saving()">
                        @if (saving()) {
                        <span class="btn-spinner"></span>
                        Saving...
                        } @else {
                        Save Changes
                        }
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>
}

<!-- Loading State -->
<div class="loading-state" *ngIf="loading()">
    <div class="spinner"></div>
    <p>Loading user...</p>
</div>